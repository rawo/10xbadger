---
import Layout from "@/layouts/Layout.astro";
import { ResetPasswordView } from "@/components/auth/ResetPasswordView";

/**
 * Reset Password Page
 *
 * Allows users to set a new password using a recovery token from their email.
 * The token is validated before allowing password reset.
 *
 * Query Parameters:
 * - token: Password reset token from email link (required)
 * - error: Error code to display (e.g., invalid_token, weak_password, passwords_dont_match)
 */

const token = Astro.url.searchParams.get("token") || "";
const error = Astro.url.searchParams.get("error") || undefined;

// If no token provided, redirect to forgot password page
if (!token) {
  return Astro.redirect("/forgot-password?error=invalid_token");
}
---

<Layout title="Reset Password - 10xbadger">
  <ResetPasswordView client:load token={token} error={error} />
</Layout>
