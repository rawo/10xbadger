---
import Layout from "@/layouts/Layout.astro";
import { PromotionCreateView } from "@/components/promotions/PromotionCreateView";
import { requireAuth } from "@/lib/auth/server-auth";

// Require authentication - redirects to login if not authenticated
const user = await requireAuth(Astro);
if (user instanceof Response) {
  return user;
}

const url = new URL(Astro.request.url);
const templateId = url.searchParams.get("template_id") || undefined;
---

<Layout title="Create Promotion | Badger" user={user}>
  <main>
    <PromotionCreateView client:load templateId={templateId} />
  </main>
</Layout>
